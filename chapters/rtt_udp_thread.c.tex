\noindent
\normalfont
%\ttfamily
\hlstd{}\hllin{01\ }\hlkwb{static\ void\ }\hlstd{}\hlkwd{udp1\textunderscore thread\textunderscore entry}\hlstd{}\hlopt{(}\hlstd{}\hlkwb{void}\hlstd{}\hlopt{{*}\ }\hlstd{parameter}\hlopt{)}\\
\hllin{02\ }\hlstd{}\hlopt{\{}\\
\hllin{03\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlslc{//限于篇幅，这部分代码仅给出大致框架，不列举全部内容;}\\
\hllin{04\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlslc{//变量定义、声明和初始化;}\\
\hllin{05\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlslc{//初始化WIFI模块配置;}\\
\hllin{06\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlslc{//尝试通过WIFI连接到路由器;}\\
\hllin{07\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlslc{//创建UDP连接到服务器;}\\
\hllin{08\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlslc{//更新当前命令;}\\
\hllin{09\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlkwa{while\ }\hlstd{}\hlopt{(}\hlstd{}\hlnum{1}\hlstd{}\hlopt{)}\\
\hllin{10\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlopt{\{}\\
\hllin{11\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{pt}\hlopt{{[}}\hlstd{}\hlnum{1}\hlstd{}\hlopt{{]}=}\hlstd{butn\textunderscore cmd}\hlopt{;}\\
\hllin{12\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{switch}\hlstd{}\hlopt{(}\hlstd{butn\textunderscore cmd}\hlopt{)}\\
\hllin{13\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlopt{\{}\\
\hllin{14\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore REPORT\textunderscore RQST}\hlopt{:}\\
\hllin{15\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器报告系统状态;}\\
\hllin{16\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{17\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore VOICE\textunderscore RQST}\hlopt{:}\\
\hllin{18\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器发出语音呼叫请求;}\\
\hllin{19\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{20\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore VOICE\textunderscore DATA}\hlopt{:}\\
\hllin{21\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器发送本机采集到的语音数据流;}\\
\hllin{22\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{23\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore CONFIG\textunderscore RQST}\hlopt{:}\\
\hllin{24\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器发出系统参数配置请求;}\\
\hllin{25\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{26\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore CONFIG\textunderscore RPLY}\hlopt{:}\\
\hllin{27\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器恢复已经收到参数配置信息;}\\
\hllin{28\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{29\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore SET\textunderscore ALARM}\hlopt{:}\\
\hllin{30\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器发出语音呼叫请求;}\\
\hllin{31\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{32\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore NONE}\hlopt{:}\\
\hllin{33\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//空命令;}\\
\hllin{34\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{35\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore UDP\textunderscore RQST}\hlopt{:}\hlstd{}\hlslc{//UDP打洞请求}\\
\hllin{36\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//向服务器发出UDP打洞请求（用于系统与服务器不在同一网段的情况）;}\\
\hllin{37\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{38\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{case\ }\hlstd{BUTN\textunderscore CMD\textunderscore SYS\textunderscore RESET}\hlopt{:}\\
\hllin{39\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//系统出错时进行复位;}\\
\hllin{40\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{break}\hlstd{}\hlopt{;}\\
\hllin{41\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlopt{\}}\\
\hllin{42\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlopt{\}}\\
\hllin{43\ }\hlstd{}\hlopt{\}}\hlstd{}
\mbox{}
\normalfont
\normalsize
